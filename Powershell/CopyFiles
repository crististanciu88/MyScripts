# Define the source folder and files to be copied
$sourceFolder = "\\network\folder\libs"
$libsToCopy = @("lib1.dll", "lib2.dll", "lib3.dll")

# Define the destination folder on the servers
$destinationFolder = "C:\Destination\Folder"

# Define the list of servers
$servers = @("Server1", "Server2", "Server3") # Add more server names as needed

# Define the service name to be restarted
$serviceName = "YourServiceName"

# Loop through each server
foreach ($server in $servers) {
    # Copy each lib to the destination folder on the server
    foreach ($lib in $libsToCopy) {
        Copy-Item -Path "$sourceFolder\$lib" -Destination "\\$server\$destinationFolder" -Force
    }

    # Restart the service
    Write-Host "Restarting $serviceName on $server..."
    Restart-Service -Name $serviceName -ComputerName $server -Force
}

$currentTime = Get-Date -Format "yyyy-MM-dd HH:mm:ss"
$cpuStatus = Get-CimInstance Win32_PerfFormattedData_PerfOS_Processor | Select-Object -Property Name, PercentProcessorTime
$cpuProcesses = Get-CimInstance Win32_PerfFormattedData_PerfProc_Process | Where-Object { $_.PercentProcessorTime -gt 0 } | Sort-Object -Property PercentProcessorTime -Descending | Select-Object -Property Name, PercentProcessorTime

Write-Output "Current TIME:"
Write-Output "_________________________"
$currentTime
Write-Output "CPU Status:"
Write-Output "_________________________"
$cpuStatus | Format-Table

Write-Output "Processes Consuming CPU:"
Write-Output "_________________________"
$cpuProcesses | Format-Table
